import{M as e,R as a,C as s,B as t}from"./@arco-design-BJ-ThMXq.js";import{M as r}from"./Marketplace-8QyBFxvP.js";import{a as l}from"./axios-FT5ipKkF.js";import{u as i}from"./vue-router-3lz8Ac5B.js";import{B as n,C as o,f as m,p as d}from"./ethers-Bs4S-GtA.js";import{e as u,r as c,o as p,h as w,k as f,j as g,s as v,l as x,a1 as y,y as h,z as j,n as b,m as k}from"./@vue-DVdXjGaL.js";import"./resize-observer-polyfill-zrGQmaJP.js";import"./vite-plugin-node-polyfills-Dh68s0dh.js";import"./compute-scroll-into-view-DCNUDwgY.js";import"./b-tween-Bhjdt4nK.js";import"./dayjs-Cc8YkNtQ.js";import"./number-precision-BB5CzNB6.js";import"./scroll-into-view-if-needed-CcisqVa9.js";import"./b-validate-BXhoJxPC.js";import"./@adraffy-Crx4Gj2H.js";const I=["src","alt"],N={class:"text-sm font-medium"},M={class:"text-sm font-medium"},T={key:1,class:"text-emerald-700"},F=u({name:"NftPage",__name:"nftPage",setup(u){const F=c("0x"),_=c({price:0,tokenId:0,seller:"",owner:"",image:"",name:"",description:""}),P=i();return p(async()=>{try{const a=P.params?await P.params.tokenId:null;a&&await(async a=>{if(!window.ethereum)return _.value={price:0,tokenId:0,seller:"",owner:"",image:"",name:"",description:""},F.value="0x",void e.warning("Please install MetaMask!");try{const e=new n(window.ethereum),s=await e.getSigner();F.value=await s.getAddress()||"0x";const t=new o(r.address,r.abi,await s),i=await t.getListedTokenForId(a),d=await t.tokenURI(a),u=await l.get(d),c={price:Number(m(i[3],"ether"))||0,tokenId:parseInt(i[0])||0,seller:i[2],owner:i[1],image:u.data.image,name:u.data.name,description:u.data.description};_.value=c}catch(s){e.error("NFT失败：",s)}})(Number(a))}catch(a){}}),(l,i)=>{const m=s,u=t,c=a;return g(),w(c,{class:"flex w-full text-white py-[6rem] gap-10",style:{"align-items":"stretch","justify-content":"space-evenly"}},{default:f(()=>[v(m,{xs:20,sm:18,md:14,lg:10,xl:10,xxl:10},{default:f(()=>[x("img",{class:"flex w-full h-full object-cover",src:y(_).image,alt:y(_).name},null,8,I)]),_:1}),v(m,{xs:20,sm:18,md:14,lg:10,xl:10,xxl:10,class:"border-b-2 font-bold text-xl border p-5 w-fit shadow-lg rounded-lg space-y-8"},{default:f(()=>[x("div",null,[i[1]||(i[1]=h(" Name ",-1)),x("span",null,j(y(_).name),1)]),x("div",null,[i[2]||(i[2]=h(" Description: ",-1)),x("span",null,j(y(_).description),1)]),x("div",null,[i[3]||(i[3]=h(" Price: ",-1)),x("span",null,j(y(_).price+"ETH"),1)]),x("div",null,[i[4]||(i[4]=h(" Owner: ",-1)),x("span",N,j(y(_).owner),1)]),x("div",null,[i[5]||(i[5]=h(" Seller: ",-1)),x("span",M,j(y(_).seller),1)]),x("div",null,[y(F)!==y(_).owner&&y(F)!==y(_).seller?(g(),w(u,{key:0,type:"primary",onClick:i[0]||(i[0]=a=>(async a=>{var s;if(!window.ethereum)return _.value={price:0,tokenId:0,seller:"",owner:"",image:"",name:"",description:""},F.value="0x",void e.warning("Please install MetaMask!");try{const s=d(_.value.price.toString(),"ether"),t=new n(window.ethereum),l=await t.getSigner(),i=new o(r.address,r.abi,await l),m=await i.executeSale(a,{value:s});await m.wait(),e.success("You successfully bought the NFT!")}catch(t){e.error("购买NFT失败：",null==(s=null==t?void 0:t.data)?void 0:s.message)}})(y(_).tokenId))},{default:f(()=>[...i[6]||(i[6]=[h(" Buy this NFT ",-1)])]),_:1})):b("",!0),y(F)==y(_).owner||y(F)==y(_).seller?(g(),k("p",T,j("You are the owner of this NFT"))):b("",!0)])]),_:1})]),_:1})}}});export{F as default};
